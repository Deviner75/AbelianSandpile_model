kernel void sandModel( 
                 int h_length, 
                 global float * h ,
                 int dir_length, 
                 global int * dir ,
                 int neighbours_length, 
                 global int * neighbours_index, 
                  global int * neighbours ,
                 float  mass 
)
{
    int idx = get_global_id(0);
    if (idx >= h_length)
        return;
        
    int nstart = neighbours_index[idx];
    int nend = neighbours_index[idx+1];

    // Array of points with valid threshold
    for (int nidx = nstart; nidx < nend; ++nidx)
    {
        int nptidx = neighbours[nidx]; // near point index
        if (dir[nptidx] == idx)
        {
            h[idx] += mass;
        }
    }
}
